<%@ page language="java" contentType="text/html; charset=UTF-8"
pageEncoding="UTF-8"%>
<%
String path = request.getContextPath();
String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path+"/";
%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ page import="java.util.ArrayList"  %>
<%@ page import="com.itheima.model.CustomerInfo"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
<!DOCTYPE html>
<html>
<head>
	<base href="<%=basePath %>">
	<meta charset="utf-8" />
		<title>ERPDemo</title>
		<link rel="stylesheet" href="css/style.css" />
		<link rel="stylesheet" href="css/left-nav.css" />
		<link rel="stylesheet" href="css/util.css" />
		<link rel="stylesheet" href="css/datatable.css" />
		<link rel="stylesheet" href="css/curd.css" />
		<style>
			.totalInfo .hor{
				width:90px;
			}
			.totalInfo-box  .title-tr{
				color:rgba(0,0,0,.65);
			}
			.totalInfo-box  .row{
				color:rgba(255,255,255,1);
			}
			/*.totalInfo-box  .row:hover:not(.title-tr) .val{
				background-color: #ddd;
			}*/
			.tinfo-1{
				background-color: #FF6666;
			}
			.tinfo-2{
				background-color: #FF9933;
			}
			.tinfo-3{
				background-color: #FF9966;
			}
			.tinfo-4{
				background-color: #669933;
			}
			.tinfo-5{
				background-color: #FF6600;
			}
			.tinfo-6{
				background-color: #3399CC;
			}
			.tinfo-7{
				background-color: #6666CC;
			}
			/*.tinfo-1,.tinfo-2,.tinfo-3,.tinfo-4,.tinfo-5,.tinfo-6,.tinfo-7{}*/
		</style>
	</head>
	<body>
		<div class="left-nav">
			<!-- head -->
			<div class="title borb">
				<div class="icon iconfont">
					<img src="img/AdminLTELogo.png"/>
				</div>
				<span class="text">ERP</span>
			</div>
			<!-- 用户信息 -->
			<div class="user borb">
				<div class="user-imgdiv icon">
					<img src="img/userImg.png" /> 
				</div>
				<span class="text"><a href="">Alexander Pierce</a></span>
			</div>
			<!-- 导航 -->
			<ul class="nav-list">
				<!-- 业务表导航 -->
				<li class="nav-item">
					<div class="nav-head borb">
						<div class="text-icon head-icon icon"><span class="icon-text">@modFirstName</span></div>
						<span class="text">@modName</span>
					</div>
					<ul class="select-list">
						@selectItem
						<li class="@select-ItemClass">
							<a href="@subModLink" class="select-a @subMod-LinkClass">
								<div class="text-icon icon"><span class="icon-text">@subModFirstName</span></div>
								<span class="select-text text">@subModName</span>
								@menuSign<div class="menu-sign"><</div>@/menuSign
							</a>
							@subsubList
							<ul class="subsublist">
								@subsubItem
								<li class="subsubitem">
									<a href="@subsubModLink" class="select-a @selected">
										<div class="text-icon icon"><span class="icon-text">@subsubModFirstName</span></div>
										<span class="select-text text">@subsubModName</span>
									</a>
								</li>
								@/subsubItem
							</ul>
							@/subsubList
						</li>
						@/selectItem
					</ul>
			<div class="select">
			</div>
			
			<div class="icon iconfont"></div>
		</div>
		<div class="body">
			<div class="head">
				<div class="head-left">
					<ul class="head-list">
						<li class="head-item iconfont" id="close-left-nav"><a href="javascript:;">&#xe606;</a></li>
						<li class="head-item tablelink"><a href="index.html">主页</a></li>
                        @headItem
						<li class="head-item tablelink">
							<a class="mainlink" href="@modLink">@modName</a>
							<div class="dropdown-content">
								<ul class="droplist">
                                    @subMod-item
									<li class="dropitem">
										<a class="droplink" href="@subModLink">@subModName</a>
									</li>
                                    @/subMod-item
								</ul>
							</div>
						</li>
                        @/headItem
<!--foot-->
					</ul>
				</div>
				<div class="head-right">
					<ul class="head-list">
						<li class="head-item iconfont"><a href="">&#xe607;</a></li>
						<li class="head-item iconfont"><a href="">&#xe638;</a></li>
						<li class="head-item iconfont"><a href="" style="font-size:1.3rem;">&#xe624;</a></li>
						<form action="" class="search">
							<div class="search-group">
								<input type="search" placeholder="Search" class="search-text"/>
								<input type="submit" class="search-submit iconfont" value="&#xe618;"/>
							</div>
						</form>
					</ul>
				</div>
			</div>
			<div class="content">
				<div class="content-head">
					<div class="head-left">
						<h2>康明订单</h2>
					</div>
					<div class="head-right">
						<a href="index.html">Home</a>
						<span class="sep">/</span>
						<span>康明订单</span>
						<span class="sep">/</span>
						<span>用户权限管理</span>
					</div>
					<div class="totalInfo-box">
						<a class="dropdownLink" id="totalInfoLink" href="javascript:;">统计信息</a>
						<div class="table-box" id="totalInfoTableBox">
							<table class="totalInfo">
								<tr class="row">
									<th class="hor val tinfo-1" colspan="1">仓管员</th>
									<th class="hor val tinfo-1" colspan="1">陈燕</th>
									<th class="hor val tinfo-1" colspan="1">运行天数</th>
									<th class="hor val tinfo-1" colspan="1">122</th>
									<th class="hor val tinfo-2" colspan="2">版本更新日期</th>
									<th class="hor val tinfo-2" colspan="2">4月10日</th>
									<th class="hor val tinfo-2" colspan="2">开始运行日期</th>
									<th class="hor val tinfo-2" colspan="2">3月17日</th>
								</tr>
								<tr class="row title-tr">
									<th class="hor val tinfo-3" colspan="1">预出库数量</th>
									<th class="hor val tinfo-3" colspan="1">2E+05</th>
									<th class="hor val tinfo-5" colspan="1">库存填写报错</th>
									<th class="hor val tinfo-5" colspan="1">0</th>
									<th class="hor val tinfo-7" colspan="1">总订单需求数</th>
									<th class="hor val tinfo-7" colspan="1">1659326</th>
									<th class="hor val tinfo-7" colspan="1">总结库存数</th>
									<th class="hor val tinfo-7" colspan="1">1406845</th>
									<th class="hor val tinfo-6" colspan="1">预警欠数未发单数</th>
									<th class="hor val tinfo-6" colspan="1">842</th>
									<th class="hor val tinfo-4" colspan="1">拖期单数</th>
									<th class="hor val tinfo-4" colspan="1">787</th>
								</tr>
								<tr class="row" >
									<th class="hor val tinfo-3" colspan="1">预出库单数</th>
									<th class="hor val tinfo-3" colspan="1">613</th>
									<th class="hor val tinfo-5" colspan="1">订单填写报错</th>
									<th class="hor val tinfo-5" colspan="1">2</th>
									<th class="hor val tinfo-7" colspan="1">总入库数</th>
									<th class="hor val tinfo-7" colspan="1">2610076</th>
									<th class="hor val tinfo-7" colspan="1">总出库数</th>
									<th class="hor val tinfo-7" colspan="1">1203231</th>
									<th class="hor val tinfo-6" colspan="1">涉及欠数单次</th>
									<th class="hor val tinfo-6" colspan="1">302</th>
									<th class="hor val tinfo-4" colspan="1">拖期数量</th>
									<th class="hor val tinfo-4" colspan="1">-4E+05</th>
								</tr>
							</table>
						</div>
					</div>
				</div>
				<!-- 数据表格 -->
				<div class="content-body">
					<div class="table-top">
						<!--<div class="checkbox-menu">
							<input type="checkbox" name="" id="" value="" />
						</div>-->
						<div class="fl">
							<ul class="list">
								<li class="item dropdown" id="showColMenu-dropdown">
									<!-- 显示|隐藏列 -->
									<a href="javascript:;" class="dropdownLink iconfont link" style="font-size:19px;">&#xe607;</a>
									<div class="dropdown-content">
										<ul class="droplist">
											<li class="dropitem"><input class="cheb-all cur-poi" type="checkbox" checked="checked"/><span class="text">全选</span></li>
										</ul>
									</div>
								</li>
								<li class="item">
									<form action="" class="search">
										<div class="search-group">
											<input type="search" placeholder="Search" class="search-text"/>
											<input type="submit" class="search-submit iconfont" value="&#xe618;"/>
										</div>
									</form>
								</li>
							</ul>
						</div>
						<div class="fr">
							<ul class="list">
								<li class="item"><a href="javascript:;" id="addData" class="add iconfont link">&#xe627;&nbsp;添加数据</a></li>
							</ul>
						</div>
						<div class="tablename">用户权限</div>
					</div>
					<div class="table-box" id="data-table-box">
						<!-- 列筛选 -->
						<div class="colscreen-dropdown cur-def">
							<ul class="list">
								<li class="item datescreen-item">
									<span class="dropitem vec" >日期筛选<span class="fr">></span></span>
									<div class="sub-dropdown"></div>
								</li>
								<li class="item numscreen-item">
									<span class="dropitem vec" >
										数字筛选<span class="fr">></span>
										<div class="sub-dropdown">
											<select class="numscreen-select">
												<option value="cancel">无</option>
												<option value="=" selected>等于</option>
												<option value="!=">不等于</option>
												<option value=">">大于</option>
												<option value=">=">大于或等于</option>
												<option value="<">小于</option>
												<option value="<=">小于或等于</option>
											</select>
												<input type="text" class="numscreen-val">		<!-- 只能接收数字、小数点、百分号 -->
												<input type="submit" class="numscreen-all-submit cur-poi"  value="确定"/>
											<div class="bottom"></div>
										</div>
									</span>

								</li>
								<li class="item valuescreen-item">
									<span class="dropitem vec" >
										值筛选<span class="fr">></span>
										<div class="sub-dropdown">
											<form action="javascript:;" class="search">
												<div class="search-group">
													<input type="search" placeholder="Search" class="search-text colValueSearch-text" />
													<input type="submit" class="search-submit colValueSearch iconfont cur-poi colValueSearch-submit" value="&#xe618;"/>
												</div>
											</form>
											<div class="valuescreen">
												<div class="valuescreen-all-checkbox-box"><input class="valuescreen-all-checkbox" class="cur-poi" type="checkbox" checked='true' />全选</div>
												<!-- <form action="" method="post"> -->
													<input type="button" class="valuescreen-all-submit cur-poi" value="确定"/>
													<ul class="list valuescreen-all-checkbox-box-list">

													</ul>
												<!-- </form> -->
											</div>
										</div>
									</span>
								</li>
								<li class="item cancelscreen-item">
									<a class="dropitem vec cancelscreen-link" >取消筛选</a>
								</li>
							</ul>
						</div>
						<input type="hidden" id="colSum" value="6"/>
						<input type="hidden" id="tableName" value="Account"/>
						<table class="datatable">
							<tr class="colname-tr">
								<th class="colname-th">选择
									<div class="menu">
										<span class=" iconfont" id="sort-cancel-all">一</span><br/>
									</div>
								</th>
								<th class="colname-th"><span class="colname-text numCol">序号</span>
									<div class="menu">
										<span class="sortSign iconfont">&#xe660;</span><br/>
										<span class="sort-cancel iconfont">一</span><br/>
									</div>
								</th>
								<th class="colname-th "><span class="colname-text strCol">姓名</span>
									<div class="menu">
										<span class="sortSign iconfont">&#xe660;</span><br/>
										<span class="sort-cancel iconfont">一</span><br/>
									</div>
								</th>
								<th class="colname-th "><span class="colname-text strCol">用户密码</span>
									<div class="menu">
										<span class="sortSign iconfont">&#xe660;</span><br/>
										<span class="sort-cancel iconfont">一</span><br/>
									</div>
								</th>
								<th class="colname-th "><span class="colname-text strCol">用户名/邮箱</span>
									<div class="menu">
										<span class="sortSign iconfont">&#xe660;</span><br/>
										<span class="sort-cancel iconfont">一</span><br/>
									</div>
								</th>
								<th class="colname-th "><span class="colname-text strCol">权限</span>
									<div class="menu">
										<span class="sortSign iconfont">&#xe660;</span><br/>
										<span class="sort-cancel iconfont">一</span><br/>
									</div>
								</th>
								<th class="colname-th "><span class="colname-text strCol">状态</span>
									<div class="menu">
										<span class="sortSign iconfont">&#xe660;</span><br/>
										<span class="sort-cancel iconfont">一</span><br/>
									</div>
								</th>
								<th class="colname-th ">操作</th>
							</tr>
							<tr class="colscreen-tr" valign="top">
								<th></th>
								<th class="colscreen-td">
									<span class="colscreen iconfont"><span class="text">&#xe83b;</span></span>
								</th>
							</tr>
							<!-- 表格数据 -->
							<c:forEach items="${datas }" var="data" varStatus="idx">
								<tr class="row">
									<th class="hor"><input type="checkbox" class="datatable-checkbox" /></th>
									<th class="hor val">${data.id}</th>
									<th class="hor val">${data.name}</th>
									<th class="hor val">${data.password}</th>
									<th class="hor val">${data.user}</th>
									<th class="hor val">${data.role}</th>
									<th class="hor val">${data.state}</th>
									<th class="hor iconfont sep-hor">
										<a href="javascript:;" class="editData" name="${data.id }" style="font-size:1.3rem;">&#xe612;</a>
										&emsp;
										<a href="javascript:;" class="delData" name="${data.id }" onclick="delData(this)" style="font-size:1rem;">&#xe78d;</a>
									</th>
								</tr>
							</c:forEach>
						</table>
					</div>
					<div class="pageLink-box">
						<input type="hidden" id="pageIdx" value="${pageIdx }"/>
						<input type="hidden" id="dataCount" value="${dataCount }"/>
						<input type="hidden" id="pageDataCount" value="${pageDataCount }"/>
						<!-- 数据页数导航条 -->
						<ul class="list">
						</ul>
					</div>
				</div>
			</div>
			<div class="foot">
				<span class="pull-right">xxxx系统&emsp;version: 1.3.4</span>
				<span class="pull-left">@2020 Copyright&emsp;<a class="link" href="http://www.beian.miit.gov.cn/">赣ICP备111111111号</a></span>
			</div>
		</div>

		<!--添加页面-->
		<div id="addBox">
			<div class="box-head">
				<span class="title">添加账户</span>
				<div class="fr">
					<a href="javascript:;" class="close" id="close-addBox">×</a>
				</div>
			</div>
			<div class="box-body">
				<div class="addTable-box">
					<table id="add-table">
						<thead>
						<tr class="colName-tr">
							<th class="colName">姓名</th>
							<th class="colName">用户密码</th>
							<th class="colName">用户名/邮箱</th>
							<th class="colName">权限</th>
							<th class="colName">状态</th>
							<th class=""></th>
							<th class=""></th>
						</tr>
						</thead>
						<tbody id="add-tbody">
						<tr class="data-tr">
							<td class="data"><input type="text" name="" id="" class="dataInput name" value="" /></td>
							<td class="data"><input type="text" name="" id="" class="dataInput password" value="" /></td>
							<td class="data"><input type="text" name="" id="" class="dataInput user" value="" /></td>
							<td class="data"><input type="text" name="" id="" class="dataInput role" value="" /></td>
							<td class="data"><input type="text" name="" id="" class="dataInput state" value="" /></td>
							<td class="addBT-td"><input type="button" name=""  class="adBT" id="addBT" value="+" /></td>
							<td class="delBT-td"><input type="button" name=""  class="adBT" id="delBT" value="-" /></td>
						</tr>
						</tbody>
					</table>
				</div>
			</div>
			<div class="box-foot">
				<ul class="footBT-list">
					<li class="footBT-item"><input type="button" class="footBT cur-poi" id="submit-addAll" value="批量添加" /></li>
					<li class="footBT-item"><input type="button" class="footBT cur-poi close" value="取消" /></li>
				</ul>
			</div>
		</div>

		<!--编辑页面-->
		<div id="editBox">
			<div class="box-head">
				<span class="title">编辑账户</span>
				<div class="fr">
					<a href="javascript:;" class="close">×</a>
				</div>
			</div>
			<div class="box-body">
				<div class="table-box">
					<table id="table">
						<tbody class="edit-tbody">
						<tr class="line">
							<td class="colName">序号：</td>
							<td class="data"><input type="text" name="" id="" disabled class="dataInput id" value="" /></td>
						</tr>
						<tr class="line">
							<td class="colName">姓名：</td>
							<td class="data"><input type="text" name="" id="" class="dataInput name" value="" /></td>
						</tr>
						<tr class="line">
							<td class="colName">用户密码：</td>
							<td class="data"><input type="text" name="" id="" class="dataInput password" value="" /></td>
						</tr>
						<tr class="line">
							<td class="colName">用户名/邮箱：</td>
							<td class="data"><input type="text" name="" id="" class="dataInput user" value="" /></td>
						</tr>
						<tr class="line">
							<td class="colName">权限：</td>
							<td class="data"><input type="text" name="" id="" class="dataInput role" value="" /></td>
						</tr>
						<tr class="line">
							<td class="colName">状态：</td>
							<td class="data"><input type="text" name="" id="" class="dataInput state" value="" /></td>
						</tr>
						</tbody>
					</table>
				</div>
			</div>
			<div class="box-foot">
				<ul class="footBT-list">
					<li class="footBT-item"><input type="button" class="footBT cur-poi" id="submit-edit" value="提交" /></li>
					<li class="footBT-item"><input type="button" class="footBT cur-poi close" value="取消" /></li>
				</ul>
			</div>
		</div>
		<div class="completeValBox">
			<div class="cont">
				<span class="text"></span>
				<div class="iconfont close">×</div>
			</div>
		</div>
		<script type="text/javascript" src="js/jquery-3.4.1.js" ></script>
		<script type="text/javascript">
			function getAddDatas(){
				var $dataTrs = $('#addBox .data-tr');
				var datas = new Array();
				for(var i = 0;i < $dataTrs.length;i++){
					var $data = $dataTrs.eq(i);		//单行数据
					datas[i] = {
						name:				$data.find('.name').val(),
						password:				$data.find('.password').val(),
						user:				$data.find('.user').val(),
						role:				$data.find('.role').val(),
						state:				$data.find('.state').val()
					};
				}
				return datas;
			}
			//将编辑后的数据封装进data中提交给ajax
			function getEditData(){
				var $editTbody = $('#editBox .edit-tbody');
				//接收时全部接收，修改哪些取决于后台mapper语句
				var data = {
					id:             $editTbody.find(".roleId").val(),
					name:             $editTbody.find(".name").val(),
					password:              $editTbody.find(".password").val(),
					user:              $editTbody.find(".user").val(),
					role:              $editTbody.find(".role").val(),
					state:              $editTbody.find(".state").val()
				};
				return data;
			}
			function refreshSuc(hash){
				console.log(hash);
				var datas = hash.datas;
				dataCount = hash.dataCount;
				pageIdx = hash.pageIdx;
				refreshDataPageLinks();
				var datatable = document.getElementsByClassName("datatable")[0];
				$('.datatable .row').remove();
				for(var i = 0;i < datas.length;i++){
					var $newRow = $dataRowTemp.clone(true);
					var $vals = $newRow.children('.val');
					$vals.eq(0).html(datas[i].id);
					$vals.eq(1).html(datas[i].name);
					$vals.eq(2).html(datas[i].password);
					$vals.eq(2).html(datas[i].user);
					$vals.eq(2).html(datas[i].role);
					$vals.eq(2).html(datas[i].state);
					$newRow.find(".editData").attr("name",datas[i].id);
					$newRow.find(".delData").attr("name",datas[i].id);
					$('.datatable').append($newRow);
				}
			}
			function editSuc(data) {
				var $editTbody = $('#editBox .edit-tbody');
				$editTbody.find(".id").val(data.roleId);
				$editTbody.find(".name").val(data.roleUser);
				$editTbody.find(".password").val(data.strRole);
				$editTbody.find(".user").val(data.strRole);
				$editTbody.find(".role").val(data.strRole);
				$editTbody.find(".state").val(data.strRole);
			}
			//隐藏列表
			var hiddenCols = [];
		</script>
		<script charset="UTF-8" src="js/init.js"></script>
		<script charset="UTF-8" src="js/funcsOfAjax.js"></script>
		<script charset="UTF-8" src="js/event.js"></script>
		<script charset="UTF-8" src="js/endInit.js"></script>
	</body>
</html>